---
  - name: wordpress
    gather_facts: no
    hosts: wordpress
    tasks:
      - name: update packages on servers
        yum:
          name: '*'
          state: latest

      - name: Install Apache
        yum: 
          name: httpd
          state: latest
      
      - name: Start service httpd if not started
        systemd:
          state: started 
          enabled: yes
          name: httpd
     
      - name: Install mariadb.server and mariadb
        yum:
          name:
            - mariadb-server
            - mariadb
          state: latest
      
      - name: start mariadb
        systemd:
          name: mariadb
          state: started
          enabled: yes
     
      - name: Install php and php-mysql
        yum:
          name: 
            - php
            - php-mysql
            - php-gd
          state: latest
     
      - name: Restart httpd and mariadb
        systemd:
          name: httpd
          name: mariadb
          name: httpd
          state: restarted

      - name: install epel-release
        yum:
          name: 
            - epel-release
            - yum-utils
          state: latest
      - name: download and install remi-release-7
        yum:
          name: http://rpms.remirepo.net/enterprise/remi-release-7.rpm
          state: present
     
      - name: enable remi-release72 and install php
        yum:
          enablerepo: "remi,remi-php72"
          name: 
            - php
            - php-common
            - php-opcache
            - php-mcrypt
            - php-cli
            - php-gd
            - php-curl
            - php-mysql
          state: latest
      
      - name: wordpress
        get_url:
          url: http://wordpress.org/latest.tar.gz
          dest: /tmp/
      
      - name: Unarchive wordpress
        unarchive:
          src: /tmp/wordpress-5.5.1.tar.gz
          dest: /tmp/
          remote_src: yes
      
      - name: Synchronize wordpress directory with html directory
        synchronize:
          mode: pull
          src: /tmp/wordpress/
          dest: /var/www/html/
        delegate_to: wordpress